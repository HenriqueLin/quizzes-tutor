<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pt"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TournamentRequiredService.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">tournament</a> &gt; <a href="index.source.html" class="el_package">pt.ulisboa.tecnico.socialsoftware.tournament.services.remote</a> &gt; <span class="el_source">TournamentRequiredService.java</span></div><h1>TournamentRequiredService.java</h1><pre class="source lang-java linenums">package pt.ulisboa.tecnico.socialsoftware.tournament.services.remote;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import pt.ulisboa.tecnico.socialsoftware.dtos.tournament.ExternalStatementCreationDto;
import pt.ulisboa.tecnico.socialsoftware.dtos.tournament.TopicWithCourseDto;
import pt.ulisboa.tecnico.socialsoftware.exceptions.TutorException;
import pt.ulisboa.tecnico.socialsoftware.tournament.TournamentACL;
import pt.ulisboa.tecnico.socialsoftware.tournament.domain.TournamentCreator;
import pt.ulisboa.tecnico.socialsoftware.tutor.api.MonolithService;
import pt.ulisboa.tecnico.socialsoftware.tutor.answer.dto.StatementQuizDto;
import pt.ulisboa.tecnico.socialsoftware.dtos.execution.CourseExecutionDto;
import pt.ulisboa.tecnico.socialsoftware.dtos.quiz.QuizDto;
import pt.ulisboa.tecnico.socialsoftware.tournament.domain.TournamentCourseExecution;
import pt.ulisboa.tecnico.socialsoftware.tournament.domain.TournamentParticipant;
import pt.ulisboa.tecnico.socialsoftware.tournament.domain.TournamentTopic;
import pt.ulisboa.tecnico.socialsoftware.dtos.user.UserDto;

import java.util.HashSet;
import java.util.List;
import java.util.Set;

import static pt.ulisboa.tecnico.socialsoftware.exceptions.ErrorMessage.USER_NOT_FOUND;

@Service
<span class="fc" id="L26">public class TournamentRequiredService {</span>

    @Autowired
    private MonolithService monolithService;

    @Autowired
    private TournamentACL tournamentACL;

    public TournamentCreator getTournamentCreator(Integer userId) {
        //User user = userRepository.findById(userId).orElseThrow(() -&gt; new TutorException(USER_NOT_FOUND, userId));
<span class="fc" id="L36">        UserDto userDto = monolithService.findUserById(userId);</span>
<span class="fc bfc" id="L37" title="All 2 branches covered.">        if (userDto != null) {</span>
<span class="fc" id="L38">            return tournamentACL.userToTournamentCreator(userDto);</span>
        }
        else {
<span class="fc" id="L41">            throw new TutorException(USER_NOT_FOUND, userId);</span>
        }
    }

    public TournamentParticipant getTournamentParticipant(Integer userId) {
        //User user = userRepository.findById(userId).orElseThrow(() -&gt; new TutorException(USER_NOT_FOUND, userId));
<span class="fc" id="L47">        UserDto userDto = monolithService.findUserById(userId);</span>
<span class="fc bfc" id="L48" title="All 2 branches covered.">        if (userDto != null) {</span>
<span class="fc" id="L49">            return tournamentACL.userToTournamentParticipant(userDto);</span>
        }
        else {
<span class="fc" id="L52">            throw new TutorException(USER_NOT_FOUND, userId);</span>
        }
    }

    public TournamentCourseExecution getTournamentCourseExecution(Integer courseExecutionId) {
        //CourseExecution courseExecution = courseExecutionRepository.findById(courseExecutionId).orElseThrow(() -&gt; new TutorException(COURSE_EXECUTION_NOT_FOUND, courseExecutionId));
<span class="fc" id="L58">        CourseExecutionDto courseExecutionDto = monolithService.getCourseExecutionById(courseExecutionId);</span>
<span class="fc" id="L59">        return tournamentACL.courseExecutionToTournamentCourseExecution(courseExecutionDto);</span>
    }

    public Integer getDemoCourseExecutionId() {
<span class="nc" id="L63">        return monolithService.getDemoCourseExecutionId();</span>
    }

    public Set&lt;TournamentTopic&gt; getTournamentTopics(Set&lt;Integer&gt; topicsList) {
<span class="fc" id="L67">        List&lt;TopicWithCourseDto&gt; topicWithCourseDtoList = monolithService.findTopics(topicsList);</span>
<span class="fc" id="L68">        Set&lt;TournamentTopic&gt; topics = new HashSet&lt;&gt;();</span>

        /*for (Integer topicId : topicsList) {
            TopicWithCourseDto topic = topicService.findTopicById(topicId);
            if(topic != null) {
                topics.add(tournamentACL.topicToTournamentTopic(topic));
            }
            else{
                throw new TutorException(TOPIC_NOT_FOUND, topicId);
            }
        }*/

<span class="fc bfc" id="L80" title="All 2 branches covered.">        for (TopicWithCourseDto topicWithCourseDto : topicWithCourseDtoList) {</span>
<span class="fc" id="L81">            topics.add(tournamentACL.topicToTournamentTopic(topicWithCourseDto));</span>
<span class="fc" id="L82">        }</span>

<span class="fc" id="L84">        return topics;</span>
    }

    public Integer getQuizId(Integer creatorId, Integer courseExecutionId, ExternalStatementCreationDto quizDetails) {
<span class="fc" id="L88">        return monolithService.generateQuizAndGetId(creatorId, courseExecutionId, quizDetails);</span>
    }

    public StatementQuizDto startTournamentQuiz(Integer userId, Integer quizId) {
<span class="fc" id="L92">        return monolithService.startQuiz(userId, quizId);</span>
    }

    public QuizDto getQuiz(Integer quizId) {
        /*Quiz quiz = quizRepository.findById(quizId)
                .orElseThrow(() -&gt; new TutorException(QUIZ_NOT_FOUND, quizId));*/

<span class="nc" id="L99">        return monolithService.findQuizById(quizId);</span>
    }

    public void updateQuiz(QuizDto quizDto) {
<span class="nc" id="L103">        monolithService.updateQuiz(quizDto);</span>
<span class="nc" id="L104">    }</span>

    public void deleteQuiz(Integer quizId) {
<span class="nc" id="L107">        monolithService.deleteExternalQuiz(quizId);</span>
<span class="nc" id="L108">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>